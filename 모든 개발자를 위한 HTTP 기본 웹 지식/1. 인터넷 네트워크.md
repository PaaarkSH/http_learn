# 인터넷 네트워크

# 인터넷 네트워크(사전학습)

- 인터넷 통신
- IP(Internet Protocol)
- TCP UDP
- PORT
- DNS

# 인터넷 통신

## 인터넷에서 컴퓨터 둘은 어떻게 통신할까?

### 구조

- 클라이언트 → 인터넷 → 서버
    - 단순히 케이블만 있으면 가능할것같음
    - 이 중간의 인터넷은 단순한 구조가 아님
    - **어떤 규칙으로 클라이언트에서 서버로 전송이 될까**

## IP(인터넷 프로토콜)

- 인터넷을 통해 다른 사람과 통신을 할 경우 어떤 규칙으로 전송을 하는가?
- **IP 주소를 통해서 가능**
- 클라이언트인 자신도 IP 주소가 있어야되고 목적지인 서버도 IP가 있어야함

### 인터넷 프로토콜의 역활

- 지정한 IP 주소에 데이터 전달
- 패킷이라는 통신 단위로 데이터 전달

### IP 패킷 정보

- 출발지 IP
- 목적지 IP
- 전송데이터
- 기타 …

### 서버 패킷 전달

- 클라이언트가 클라이언트의 IP 를 넣고 목적지 IP 를 넣고 전송 데이터를 넣어서 전달하는 방식
- **하지만 IP 라는 패킷에 담는 방식으로 한계가 있음**

### IP 프로토콜의 한계

- 비연결성
    - 패킷을 받을 대상이 없거나 서비스 불능 상태여도 패킷 전송
        - PC 가 꺼져있다던가
        - 실제로 없을 수 있다던가
- 비신뢰성: 통신 자체를 믿을 수 없음
    - 중간에 패킷이 사라지면?
    - 패킷이 순서대로 안오면?
    - 같은 피씨에서 구동중인 어플리케이션이 여러개인데 IP 가 하나라면?
        - 음악도 듣고 게임도 하고 메신저도 같이 하는 상황
- 프로그램 구분
    - 같은 IP 를 사용하는 서버에서 통신하는 어플리케이션이 둘 이상이면?

### 대상이 서비스 불능, 패킷 전송

- 대상 서버가 패킷을 받을 수 있는 상태인지 모름

### 패킷 소실

- 전달하는 중간 단계의 서버가 문제가 생겼을 경우 패킷 소실

### 패킷 전달 순서 문제 발생

- 패킷 전달시 용량이 클 경우
    - 대략 용량이 클경우 1500 바이트씩 끊어서 전달함
        - 만약 hello world 를 보낼경우 hello 가 먼저 가고 world 가 보내짐
    - 전달하는 과정에서 데이터의 순서를 보장 할 수 없음

<aside>
💡 IP 만으로 문제점들을 해결할 수 없음

</aside>

# TCP UDP

## 인터넷 프로토콜 스택의 4계층

- 어플리케이션 계층
    - http ftp
- 전송 계층
    - tcp udp
- 인터넷 계층
    - IP
- 네트워크 인터페이스 계층
    - 랜카드 등등

## 프로토콜 계층: 아래의 순서대로 SOCKET 라이브러리를 통해 전송되는 순서

- 어플리케이션
    - 웹 브라우저, 네트워크 게임, 채팅 등등
        1. **프로그램이 Hello World 메시지 생성**
    - SOCKET 라이브러리
        1. **SOCKET 라이브러리를 통해 전달**
- OS
    - TCP UDP
        1. **TCP 정보 생성 메시지 데이터 포함(TCP 데이터로 감쌈)**
    - IP
        1. **IP 패킷 생성, TCP 데이터 포함(TCP 정보 겉으로 IP 관련 패킷으로 감쌈)**
- 네트워크 인터페이스
    - LAN 드라이버, LAN 장비
        - **랜카드를 통해 밖으로 나갈때 이더넷 프레임이 포함되서 밖으로 나감**
            - 이더넷 프레임: 물리적인 MAC 주소가 포함된 정보
                - 더 깊이 설명하기엔 너무 많음

## IP 패킷 정보

- 출발지 IP
- 목적지 IP
- 패킷
    - 패키지 + 버킷(덩어리)

## TCP IP 패킷 정보

- IP 패킷 + TCP 세그먼트 + 전송정보
- TCP 세그먼트: 출발지 PORT, 목적지 PORT, 전송 제어, 순서, 검증 정보
    - IP 만으로 해결이 안됬던 순서 문제를 수정하기 위해 정보들이 추가됨

## TCP 특징

### Transmission Control Protocol: 전송 제어 프로토콜

- 연결 지향 - TCP 3 way handshake **가상 연결**
    - 연결 보증
- 데이터 전달 보증
    - 중간에 데이터가 누락된걸 알 수 있음
- 순서 보장
- **실제로 더 많지만 이정도만**
- 신뢰 할 수 있는 프로토콜
- 현재는 대부분 TCP 사용중

## TCP 3 Way Handshake

### 순서

1. syn: 접속 요청
    - 연결 요청 메세지를 전달
2. syn + ack
    - 요청 수락을 보내면서 연결요청 메시지를 전달
        - 결국 클라이언트 서버 둘다 연결 요청을 보내는 구조
3. ack: 접속 수락
4. 연결이 완료 된 이후에 데이터 전송
    - 만약에 서버가 꺼져있으면?
        - syn 전송에 대한 ack 가 없어서 전송 자체를 안함
- 요즘은 최적화가 잘되어있어서 ack 를 전송시 데이터도 같이 전송

### **3 way handshake 는 실제로 연결된게 아니고 개념적으로만 연결된 상태**

- 그냥 연결이 됬을거라고 가정만 하는 상태
- 왜냐면 클라이언트에서 서버로 가능 과정의 노드들은 서로 연결이 됬는지 안됬는지도 모름
- 통신을 위한 물리적 연결이 된게 아닌 상태

## 데이터 전달 보증

1. 데이터 전송
2. 데이터 잘 받았음
- 만약 데이터가 잘 받지 못했을 경우에 알수가 있음

## 순서 보장

- 패킷 1 2 3 순서로 전송
- 패킷 1 3 2 순서로 도착
- 다 버리고 패킷 2부터 다시 보내도록 요청
    - 요즘은 전달받는 서버에서 최적화가 되어있어서 순서 맞추기도 가능하긴함
    - TCP 패킹 안에 순서 정보나 검증 정보같은게 들어가있기 때문에 가능

## UDP 특징

### 사용자 데이터그램 프로토콜(User Datagram Procotol)

- 하얀 도화지에 비유
    - 기능이 거의 없음
- 연결 지향 - TCP 3 way handshake 없음
    - 3 way handshake 사용시에는 데이터 양도 많아지고 속도도 느려짐
- 데이터 전달 보증 X
- 순서 보장 X
- 데이터 전달 및 순서가 보장되지 않지만, 단순하고 빠름
- 정리
    - IP 와 거의 같음
    - **PORT + 체크섬 정도만 추가**
        - IP 프로토콜에는 PORT 가 없음
            - 이게 게임용 패킷인지 채팅용 패킷인지 검증용
    - 어플리케이션에서 추가 작업 필요
        - TCP 는 이미 프로토콜 작업이 너무 많아서 수정 자체가 어려움
- 요즘 각광을 받고 있음
    - 예전에 신뢰성이 있는건 TCP 를 보내고 영상같은 정보는 UDP 로 보낸다고 배웠음
        - 하지만 대부분 TCP 사용해서 보냄
    - 다시 또 시장이 바뀌어서 HTTP 통신에 사용함
        - 최근에 HTTP 3 스펙이 나왔는데 여기서 핸드쉐이킹 하는걸 최적화하려고 하고있어서 UDP 를 사용하고있음
        - 기본적으로 우리는 TCP 를 쓰고있다고 알면 됨

# PORT(항구)

## 한번에 둘 이상 연결해야 하면?

- 게임 화상통화 웹브라우저 동시에 3개의 작업을 하면 하나의 IP 클라이언트에 3개의 서버와 어떻게 작업하나?
- 이게 어디서 오는 패킷인지도 알 수 가없음

## TCP IP 패킷 정보

- TCP 패킷 정보 안에 출발지 목적지 PORT 가 들어가있음

## 패킷 정보

- 이제부터 패킷 안에 출발지 IP + PORT , 목적지 IP + PORT , 전송데이터 … 으로 들어가있음

## PORT - 같은 IP 내에서 프로세스 구분

- 0 ~ 65535 할당 가능
- 0 ~ 1023: well known port(잘 알려진 포트), 사용하지 않는게 좋음
    - FTP: 20 21
    - TELNET: 23
    - HTTP : 80
    - HTTPS: 443

# DNS

## IP 는 기억하기 어려움

- 

## IP 는 변경 될 수 있음

- 제일 큰 문제
- 

## DNS(Domain Name System)

- 전화번호부
- 도메인 명을 IP 주소로 변경
    - google 에 대한 IP 등록

## DNS 사용

- 도메인으로 먼저 찾음

## 인터넷 네트워크 정리

- 인터넷 통신
- IP
- TCP UDP
- PORT
- DNS